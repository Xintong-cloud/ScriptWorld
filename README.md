# ğŸ­ ScriptWorld â€” Multi-Agent Scripted Chatroom  
*(Murder Mystery / Roleplay Engine)*

ScriptWorld æ˜¯ä¸€ä¸ªé¢å‘â€œå‰§æœ¬æ€ / æ¡Œæ¸¸ RP / ç¤¾äº¤æ¨ç†æ¸¸æˆâ€çš„ **å¤šæ™ºèƒ½ä½“èŠå¤©å®¤å¼•æ“**ã€‚  
ä½ å¯ä»¥åœ¨åŒä¸€ä¸ªæˆ¿é—´ä¸­è¿è¡Œå¤šä¸ª AI Agentï¼Œé€šè¿‡ **Lobby æ¥å¾… â†’ DM ä¸»æŒ â†’ NPC/ç©å®¶äº’åŠ¨** çš„æµç¨‹ï¼Œå¿«é€Ÿæ­å»ºä¸€ä¸ªå¯æ‰©å±•ã€å¯å¤ç”¨çš„ã€Œå‰§æœ¬ä¸–ç•Œã€ã€‚

---

## âœ¨ é¡¹ç›®äº®ç‚¹

- âœ… å¤šæ™ºèƒ½ä½“èŠå¤©å®¤ï¼šå¤šä¸ª AI Agent åœ¨åŒä¸€ç©ºé—´åä½œæ¨è¿›å‰§æƒ…  
- âœ… **DM Agentï¼ˆä¸»æŒäººï¼‰**ï¼šç»Ÿä¸€æŒæ§æµç¨‹ã€è§„åˆ™ã€èŠ‚å¥ä¸ä¿¡æ¯å®‰å…¨  
- âœ… **Lobby Agentï¼ˆæ¥å¾…å®˜ï¼‰**ï¼šå¼•å¯¼ç©å®¶é€‰æœ¬ï¼Œå¹¶å°†ç»“æœç§å‘ç»™ DM  
- âœ… **NPC Agentsï¼ˆè§’è‰²ä»£ç†ï¼‰**ï¼šå¯æ’æ‹”çš„äººç‰© / è¯äºº / åæ´¾ / è·¯äººç³»ç»Ÿ  
- âœ… å‰§æœ¬ / äº‹ä»¶ / å·¥å…· / Mod æ¨¡å—åŒ–ï¼šç»“æ„æ¸…æ™°ï¼Œæ–¹ä¾¿æ‰©å±•æ–°ä¸–ç•Œ  
- âœ… ç½‘ç»œé…ç½® + æ•°æ®æŒä¹…åŒ–ï¼šå†…ç½® Network é…ç½®ä¸ DB å­˜å‚¨ä¼šè¯çŠ¶æ€  

---

## ğŸ¯ é€‚ç”¨åœºæ™¯

ScriptWorld é€‚åˆç”¨æ¥ï¼š

- æ­å»ºä¸€ä¸ª **AI é©±åŠ¨çš„å‰§æœ¬æ€å¹³å°**
- è¿è¡Œæµç¨‹ä¸¥è°¨çš„ **äº’åŠ¨å¼è§’è‰²æ‰®æ¼” / ç¤¾äº¤æ¨ç†æ¸¸æˆ**
- è¿›è¡Œ **å¤š Agent åä½œç ”ç©¶**ï¼ˆæ¥å¾… â†’ ä¸»æŒ â†’ NPC ç¾¤ä½“æ¼”åŒ–ï¼‰
- å¿«é€Ÿåˆ¶ä½œã€Œä¸–ç•Œ / å‰§æœ¬ / è§’è‰²ã€å¹¶æŒç»­è¿­ä»£
- ä½œä¸ºä½ çš„ **å¤šæ™ºèƒ½ä½“è„šæœ¬å¼•æ“åº•åº§**ï¼Œæ‰¿è½½æ›´å¤šç©æ³•

---

## ğŸ§  æ¶æ„æ¦‚è§ˆ

ScriptWorld çš„æ ¸å¿ƒæ˜¯ä¸€ä¸ª **Networkï¼ˆç½‘ç»œï¼‰**ï¼Œç”¨äºè¿æ¥æˆ¿é—´ã€ç©å®¶ä¸å„ç±» Agentã€‚

### æ ¸å¿ƒæ¨¡å—è¯´æ˜

| æ¨¡å— | ä½œç”¨ |
|----|----|
| `network.yaml` | å®šä¹‰èŠå¤©å®¤ç½‘ç»œã€æˆ¿é—´ã€Agent è·¯ç”± |
| `agents/` | Agent å®šä¹‰ï¼šLobbyã€DMã€NPC |
| `scenarios/` | åœºæ™¯ / ä¸–ç•Œè§‚ / æµç¨‹ç»„ç»‡ |
| `events/` | äº‹ä»¶ç³»ç»Ÿï¼šé˜¶æ®µæ¨è¿›ã€çº¿ç´¢å‘æ”¾ |
| `tools/` | Agent å¯è°ƒç”¨çš„å·¥å…· |
| `scripts/` | å‰§æœ¬å†…å®¹ï¼ˆæ¡ˆä»¶ã€è§’è‰²ã€çº¿ç´¢ã€çœŸç›¸ï¼‰ |
| `mods/` | å¯é€‰æ‰©å±•ï¼šè‡ªå®šä¹‰è§„åˆ™ä¸ç©æ³•æ’ä»¶ |
| `network.db` | æŒä¹…åŒ–å­˜å‚¨ï¼ˆä¼šè¯ã€çŠ¶æ€ã€ç©å®¶æ•°æ®ï¼‰ |

---

## ğŸ§© å·²å†…ç½®çš„ Agentï¼ˆé»˜è®¤ Agent ä½“ç³»ï¼‰

### ğŸ© DM Agentï¼ˆé€šç”¨ä¸»æŒäººï¼‰

æ–‡ä»¶ï¼š`agents/dm.yaml`

DM æ˜¯ç³»ç»Ÿä¸­çš„ **ä¸»æŒäºº / è£åˆ¤ / å™äº‹å¼•æ“**ï¼Œè´Ÿè´£ï¼š

- è¯»å–å¹¶ç†è§£å‰§æœ¬ï¼ˆå« DM-only çœŸç›¸ï¼‰
- åˆ†é…èº«ä»½ / è§’è‰²å¡
- ç»´æŒè§„åˆ™ä¸€è‡´æ€§ã€å¤„ç†å¼‚å¸¸
- æ§åˆ¶èŠ‚å¥ï¼šå¼€åœº â†’ å›åˆ â†’ çº¿ç´¢ â†’ è®¨è®º â†’ æŠ•ç¥¨ â†’ ç»“å±€
- ä¿¡æ¯éš”ç¦»ï¼šç¡®ä¿ç©å®¶åªè·å–åº”å¾—ä¿¡æ¯

**æ¨èé…ç½®æ–¹å‘ï¼š**
- è¾ƒä½ `temperature`ï¼ˆç¨³å®šæ¨è¿›ï¼‰
- è¾ƒé«˜ `max_tokens`ï¼ˆé•¿é€»è¾‘ä¸å¼•å¯¼ï¼‰
- å¢åŠ  `reaction_delay`ï¼ˆæ›´åƒçœŸäººä¸»æŒï¼‰

---

### ğŸ› Lobby Agentï¼ˆå¤§å…æ¥å¾…å®˜ï¼‰

æ–‡ä»¶ï¼š`agents/lobby.yaml`

Lobby åœ¨ `#general` æˆ¿é—´å·¥ä½œï¼Œè´Ÿè´£ï¼š

- å¼•å¯¼ç©å®¶è¿›è¡Œé€‰æœ¬ / é…ç½®  
  - äººæ•°  
  - éš¾åº¦  
  - æ°›å›´ï¼ˆæ¬¢ä¹ / ä¸¥è‚ƒ / ç¡¬æ ¸ï¼‰  
  - æ—¶é•¿  
  - ä¸»é¢˜  
- å°†é€‰æ‹©ç»“æœ **ç§å‘ç»™ DM**ï¼Œç”± DM åšå‡†å¤‡å¹¶å¼€å±€  

ç©å®¶ä½“éªŒæµç¨‹ï¼š

> ç©å®¶è¿›å…¥ â†’ Lobby æ¥å¾…é€‰æœ¬ â†’ DM å¼€å±€ä¸»æŒ â†’ NPC / ç©å®¶æ¨ç†

---

### ğŸ­ NPC Agentsï¼ˆè§’è‰²ä»£ç†ï¼‰

ç›®å½•ï¼š`agents/npcs/`

NPC Agent å¯ä»¥ä½œä¸ºï¼š

- æ•…äº‹äººç‰© / è¯äºº / è·¯äºº
- åæ´¾ / é˜´è°‹å®¶
- ç¤¾äº¤æ¨ç†æ¸¸æˆä¸­çš„ã€Œå‡ç©å®¶ã€

æ”¯æŒå³æ’å³ç”¨ï¼š  
åªéœ€æ–°å¢ YAML å¹¶åœ¨ `network.yaml` ä¸­é…ç½®è·¯ç”±ã€‚

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¼‰å®‰è£… OpenAgentsï¼ˆéœ€è¦ Python ç¯å¢ƒï¼‰

```bash
pip install openagents
```

éªŒè¯å®‰è£…ï¼š
```bash
openagents --version
```

---

### 2ï¼‰å¯åŠ¨ Network

```bash
conda activate openagents
cd script_world
openagents network start
```

Studio é»˜è®¤åœ°å€ï¼š
```
http://localhost:8700/studio/
```

---

### 3ï¼‰é…ç½® GLM-4.7ï¼ˆæ¨¡å‹æœåŠ¡ï¼‰

#### 3.1 åˆ›å»º API Key
å‰å¾€ï¼šhttps://www.bigmodel.cn/

#### 3.2 åœ¨ Studio é…ç½®æ¨¡å‹

è·¯å¾„ï¼š
```
Service Proxy â†’ Default Model Config
```

å¡«å†™ï¼š
- Providerï¼šCustom OpenAI Compatible  
- Base URLï¼šhttps://open.bigmodel.cn/api/paas/v4  
- Model Nameï¼šglm-4.7  
- API Keyï¼šä½ çš„ Key  

ç‚¹å‡» **Test**ï¼ŒæˆåŠŸå³è¡¨ç¤ºé…ç½®å®Œæˆã€‚

---

### 4ï¼‰å¯åŠ¨ ScriptWorld Agents

```bash
openagents agent start agents/lobby.yaml
openagents agent start agents/dm.yaml
openagents agent start agents/npcs/npc_1.yaml
openagents agent start agents/npcs/npc_2.yaml
openagents agent start agents/npcs/npc_3.yaml
```

---

### 5ï¼‰å¼€å§‹æ¸¸æˆ

1. è¿›å…¥ Workspace â†’ `#general`
2. å‘é€ `start`
3. é€‰æ‹©å‰§æœ¬å¹¶ç¡®è®¤
4. DM å¼€å±€ â†’ NPC / ç©å®¶è¿›å…¥æ¨ç†

---

## âš™ï¸ é…ç½®è¯´æ˜

### Agent é…ç½®ç¤ºä¾‹

```yaml
type: "openagents.agents.collaborator_agent.CollaboratorAgent"
agent_id: "dm"
display_name: "Universal DM"

config:
  model_name: "glm-4.7"
  temperature: 0.3
  max_tokens: 1500
  react_to_all_messages: false
  reaction_delay: "random(0.3, 1.2)"
  instruction: |
    ...
```

---

## ğŸ—‚ï¸ ç›®å½•ç»“æ„

```text
script_world/
â”œâ”€ agents/
â”‚  â”œâ”€ dm.yaml
â”‚  â”œâ”€ lobby.yaml
â”‚  â””â”€ npcs/
â”œâ”€ scripts/
â”œâ”€ scenarios/
â”œâ”€ events/
â”œâ”€ tools/
â”œâ”€ mods/
â”œâ”€ logs/
â”œâ”€ network.yaml
â””â”€ network.db
```

---

## ğŸ§ª è‡ªå®šä¹‰æ‰©å±•

### åˆ›å»ºæ–°å‰§æœ¬
è·¯å¾„ï¼š
```
scripts/<your_script_name>/
```

å»ºè®®åŒ…å«ï¼š
- ä¸–ç•Œè§‚ / èƒŒæ™¯
- è§’è‰²å¡
- æ—¶é—´çº¿
- åˆ†è½®çº¿ç´¢
- DM-only çœŸç›¸ï¼ˆå•ç‹¬æ–‡ä»¶ï¼‰

---

### æ–°å¢ Agent
1. æ–°å»º YAML
2. è®¾ç½®å”¯ä¸€ `agent_id`
3. åœ¨ `network.yaml` é…ç½®è·¯ç”±

---

## ğŸ—ƒï¸ æ•°æ®æŒä¹…åŒ–

- `network.db`ï¼šä¼šè¯ / çŠ¶æ€ / ç©å®¶æ•°æ®
- `logs/`ï¼šè¿è¡Œæ—¥å¿—ä¸å¤ç›˜

---

## ğŸ§° å¸¸è§é—®é¢˜

**Agent ä¸è¯´è¯**
- æ£€æŸ¥ `network.yaml`
- æŸ¥çœ‹ `logs/`

**è¾“å‡ºè¿‡äºå‘æ•£**
- é™ä½ `temperature`
- æé«˜ `max_tokens`

---

## ğŸ”’ å®‰å…¨å»ºè®®

- å‰§æœ¬åŒ…å«æ•æ„Ÿå†…å®¹æ—¶å¢åŠ  DM è¾¹ç•Œ
- å·¥å…·å±‚æ·»åŠ å®‰å…¨è¿‡æ»¤
- é¿å…å­˜å‚¨ä¸ªäººæ•æ„Ÿä¿¡æ¯

---

## ğŸ™Œ è‡´è°¢

- æ¶æ„åŸºäº OpenAgents åä½œ Agent ä½“ç³»  
- çµæ„Ÿæ¥è‡ªäº’åŠ¨å°è¯´ã€ç¤¾äº¤æ¨ç†ä¸æ¡Œæ¸¸ä¸»æŒæµç¨‹  
- é¢å‘ **å‰§æœ¬æ€ / RP / å¤šæ™ºèƒ½ä½“ç¼–æ’** çš„å¯æ‰©å±•åº•åº§
